# CUDA
<div style="text-align: right">[back](./SistemiDigitali.md)</div>

## Indice

- [CUDA](#cuda)
  - [Indice](#indice)
  - [Nascita della Computer Grafica](#nascita-della-computer-grafica)
    - [Ivan Sutherland e Sketchpad (1963)](#ivan-sutherland-e-sketchpad-1963)
  - [Prime Schede Video e Standard](#prime-schede-video-e-standard)
    - [Prime Schede Video](#prime-schede-video)
    - [Limitazioni](#limitazioni)
  - [Evoluzione della Grafica 3D](#evoluzione-della-grafica-3d)
    - [Funzionalità 3D Fondamentali](#funzionalità-3d-fondamentali)
  - [Introduzione alle GPU](#introduzione-alle-gpu)
    - [Differenze tra GPU Dedicata e Integrata](#differenze-tra-gpu-dedicata-e-integrata)
  - [Differenze tra CPU e GPU](#differenze-tra-cpu-e-gpu)
  - [CUDA: Calcolo Parallelo](#cuda-calcolo-parallelo)
    - [Struttura di un Programma CUDA](#struttura-di-un-programma-cuda)
    - [Hello World in CUDA](#hello-world-in-cuda)
    - [Strumenti CUDA](#strumenti-cuda)

## Nascita della Computer Grafica

### Ivan Sutherland e Sketchpad (1963)

Sketchpad, sviluppato nel 1963, fu il primo software di grafica interattiva, che utilizzava una penna ottica per creare immagini su schermo, aprendo la strada alla moderna computer grafica.

> **Nota:** Sketchpad dimostrò il potenziale della grafica computerizzata, ma era limitato dalle risorse computazionali dell'epoca, interamente gestite dalla CPU.

---

## Prime Schede Video e Standard

### Prime Schede Video

1. **MDA (1981)**: Supporto monocromatico per testo, 720x350 pixel.
2. **CGA (1981)**: Grafica a colori con 4 colori simultanei, 320x200 pixel.
3. **EGA (1984)**: 16 colori, risoluzione di 640x350 pixel.

> **Standard VGA:** Introdotto nel 1987, offriva retrocompatibilità e miglioramenti significativi: risoluzione 640x480 pixel, 256 colori.

### Limitazioni

- Grafica 2D, basse risoluzioni, prestazioni limitate.
- Mancanza di programmabilità, pipeline fisse.

---

## Evoluzione della Grafica 3D

### Funzionalità 3D Fondamentali

1. **Triangolazione:** Semplificazione degli oggetti 3D in triangoli.
2. **Rasterizzazione:** Conversione delle forme vettoriali in pixel.
3. **Texture Mapping:** Applicazione di immagini 2D su oggetti 3D.
4. **Shading:** Simulazione dell'interazione della luce con le superfici.

> **Ray Tracing:** Modello di rendering realistico che simula il comportamento della luce in una scena 3D. Richiede calcoli intensivi, altamente parallelizzabili.

---

## Introduzione alle GPU

Le GPU, progettate inizialmente per il rendering grafico, hanno evoluto la loro funzione verso applicazioni di calcolo generale (GPGPU).

### Differenze tra GPU Dedicata e Integrata

- **Dedicata:** Prestazioni elevate, memoria VRAM separata, consumo maggiore. Ideale per gaming e applicazioni grafiche.
- **Integrata:** Prestazioni moderate, memoria condivisa con la CPU, consumo minore. Adatta per dispositivi portatili.

---

## Differenze tra CPU e GPU

| **CPU** | **GPU** |
| --- | --- |
| Eccellente per carichi sequenziali | Ottimizzata per carichi paralleli |
| Core limitati (2-16) | Migliaia di core |
| Frequenza 2.5-5 GHz | Frequenza 1-2 GHz |
| Latenza bassa | Throughput superiore |
| Memoria DDR4/DDR5 | Memoria GDDR6/HBM2 |

> **Esempio:** Una GPU eccelle in operazioni parallele come il rendering grafico o il machine learning, mentre una CPU gestisce meglio task sequenziali come l'esecuzione di programmi.

---

## CUDA: Calcolo Parallelo

CUDA, piattaforma sviluppata da NVIDIA, semplifica il calcolo parallelo sulle GPU, consentendo lo sviluppo di applicazioni per settori come machine learning, simulazioni scientifiche e grafica avanzata.

### Struttura di un Programma CUDA

1. **Codice Host:** Eseguito sulla CPU, gestisce memoria e lancia kernel.
2. **Codice Device:** Eseguito sulla GPU, ottimizzato per operazioni parallele.

> **Kernel:** Funzione CUDA eseguita in parallelo su più thread.

### Hello World in CUDA

Esempio di kernel CUDA:

```c
#include <stdio.h>
__global__ void helloFromGPU() {
  printf("Hello, World from GPU thread %d!\n", threadIdx.x);
}

int main() {
  helloFromGPU<<<1, 10>>>();
  cudaDeviceSynchronize();
  return 0;
}
```

- `__global__`: Funzione eseguita sulla GPU.
- `threadIdx.x`: Identifica il thread all'interno del blocco.
- `cudaDeviceSynchronize()`: Garantisce che tutte le operazioni GPU siano completate prima di continuare.

### Strumenti CUDA

- **Librerie:** cuBLAS (algebra lineare), cuFFT (Fourier), cuDNN (deep learning).
- **Compilatore:** nvcc traduce il codice CUDA in PTX (Parallel Thread Execution).
- **API:** Runtime e Driver API per gestire risorse e calcoli GPU.

---

Con CUDA, NVIDIA ha trasformato le GPU in strumenti potenti per il calcolo generale, ampliando le possibilità di utilizzo in numerosi settori tecnologici.

